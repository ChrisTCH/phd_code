<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: calc_local_stats.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="calc_local_stats.c">calc_local_stats.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: <span class="c">#-----------------------------------------------------------------------------#</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: <span class="c">#                                                                             #</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="c"># This code describes a function that is designed to open FITS file images    #</span></pre>
<pre class='cython line score-0'>&#xA0;004: <span class="c"># provided to the function, and produce FITS files and images of local        #</span></pre>
<pre class='cython line score-0'>&#xA0;005: <span class="c"># statistics calculated for the diagnostic quantities, e.g. the skewness of   #</span></pre>
<pre class='cython line score-0'>&#xA0;006: <span class="c"># the polarisation gradient. This is performed for each input FITS file that  #</span></pre>
<pre class='cython line score-0'>&#xA0;007: <span class="c"># is given. The calculation of these quantities will occur in separate        #</span></pre>
<pre class='cython line score-0'>&#xA0;008: <span class="c"># functions. The images will then be saved as FITS files using the given save #</span></pre>
<pre class='cython line score-0'>&#xA0;009: <span class="c"># filename and directory.                                                     #</span></pre>
<pre class='cython line score-0'>&#xA0;010: <span class="c">#                                                                             #</span></pre>
<pre class='cython line score-0'>&#xA0;011: <span class="c"># Author: Chris Herron                                                        #</span></pre>
<pre class='cython line score-0'>&#xA0;012: <span class="c"># Start Date: 1/9/2015                                                        #</span></pre>
<pre class='cython line score-0'>&#xA0;013: <span class="c">#                                                                             #</span></pre>
<pre class='cython line score-0'>&#xA0;014: <span class="c">#-----------------------------------------------------------------------------#</span></pre>
<pre class='cython line score-0'>&#xA0;015: </pre>
<pre class='cython line score-0'>&#xA0;016: <span class="c"># Import the various packages which are required for the proper functioning of</span></pre>
<pre class='cython line score-0'>&#xA0;017: <span class="c"># this script, scipy.stats for calculating statistical quantities</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+018: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;019: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+020: <span class="k">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_fits);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_fits);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_fits);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_astropy_io, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_fits);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fits, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+021: <span class="k">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span></pre>
<pre class='cython code score-19'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_stats);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_stats);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_stats);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_stats);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_stats, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;022: </pre>
<pre class='cython line score-0'>&#xA0;023: <span class="c"># Import C specific functions to speed things up</span></pre>
<pre class='cython line score-0'>&#xA0;024: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">isnan</span><span class="p">,</span> <span class="n">NAN</span></pre>
<pre class='cython line score-0'>&#xA0;025: </pre>
<pre class='cython line score-0'>&#xA0;026: <span class="c"># Import utility functions</span></pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+027: <span class="k">from</span> <span class="nn">mat2FITS_Image</span> <span class="k">import</span> <span class="n">mat2FITS_Image</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_mat2FITS_Image);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_mat2FITS_Image);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_mat2FITS_Image);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_mat2FITS_Image, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_mat2FITS_Image);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mat2FITS_Image, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;028: </pre>
<pre class='cython line score-0'>&#xA0;029: <span class="c"># Fix a data type for the Numpy arrays that will be used in the function</span></pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+030: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s">&#39;&lt;f4&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-13'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_f4);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class='cython line score-0'>&#xA0;031: <span class="c"># Do the same thing for a compile-time type definition</span></pre>
<pre class='cython line score-0'>&#xA0;032: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">DTYPE_t</span></pre>
<pre class='cython line score-0'>&#xA0;033: </pre>
<pre class='cython line score-0'>&#xA0;034: <span class="c"># Define the function that can be imported by a calling code to calculate</span></pre>
<pre class='cython line score-0'>&#xA0;035: <span class="c"># local statistics at each pixel of an input image, and then save the resultant</span></pre>
<pre class='cython line score-0'>&#xA0;036: <span class="c"># map as a FITS file</span></pre>
<pre class='cython line score-114' onclick='toggleDiv(this)'>+037: <span class="k">def</span> <span class="nf">calc_local_stats</span><span class="p">(</span><span class="n">input_files</span><span class="p">,</span> <span class="n">output_filenames</span><span class="p">,</span> <span class="n">stat_list</span><span class="p">,</span>\</pre>
<pre class='cython code score-114'>/* Python wrapper */
static PyObject *__pyx_pw_16calc_local_stats_1calc_local_stats(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_16calc_local_stats_calc_local_stats[] = "\n\tDescription\n        This function calculates statistics for each pixel in an image, using\n        the data in surrounding pixels. The statistics that are calculated can \n        be specified in the stat_list variable. All of these statistics will\n        be calculated for each input image. Multiple input files can be \n        provided, and statistics will be calculated for each image. Maps of the\n        produced statistics will be saved using the given output filenames.\n        \n    Required Input\n        input_files - An array of strings, where each string specifies the \n        \t\t\t  directory and filename of the FITS image to calculate \n        \t\t\t  statistics for. Local statistics are calculated for each\n        \t\t\t  file provided in this array.\n        output_filenames - An array of strings, where each string specifies the \n        \t\t\t\t   directory and filename to use when saving a FITS \n        \t\t\t\t   file image of the produced statistic map. An image is\n        \t\t\t\t   saved for each input file, and each statistic. This\n        \t\t\t\t   array needs to be the same length as input_files.\n        \t\t\t\t   Each FITS file that is saved will have the type of \n        \t\t\t\t   statistic appended to the output filename provided.\n        \t\t\t\t   The given strings should not have the .fits extension\n        \t\t\t\t   present, as this is added in the function.\n        stat_list - An array of strings, where each string specifies a statistic\n        \t\t\tthat is to be calculated locally for each input image.\n        \t\t\tAllowed values are 'skewness' and 'kurtosis'.\n        box_halfwidths - The half-widths of the box to use when calculating the\n        \t\t\t\t local statistics, in pixels. This is an array of\n        \t\t\t\t positive integers greater than or equal to 1. This \n        \t\t\t\t array must have the same length as input_files. \n                   \n    Output\n        0 - An error occurred, pos""sibly due to inappropriate input values\n        1 - Function ran to completion, and saved FITS images of the calculated\n        \tstatistics maps successfully.\n\t";
static PyMethodDef __pyx_mdef_16calc_local_stats_1calc_local_stats = {"calc_local_stats", (PyCFunction)__pyx_pw_16calc_local_stats_1calc_local_stats, METH_VARARGS|METH_KEYWORDS, __pyx_doc_16calc_local_stats_calc_local_stats};
static PyObject *__pyx_pw_16calc_local_stats_1calc_local_stats(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_input_files = 0;
  PyObject *__pyx_v_output_filenames = 0;
  PyObject *__pyx_v_stat_list = 0;
  PyArrayObject *__pyx_v_box_halfwidths = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_local_stats (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_input_files,&amp;__pyx_n_s_output_filenames,&amp;__pyx_n_s_stat_list,&amp;__pyx_n_s_box_halfwidths,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_input_files)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_output_filenames)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_local_stats", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_stat_list)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_local_stats", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_box_halfwidths)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_local_stats", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_local_stats") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_input_files = values[0];
    __pyx_v_output_filenames = values[1];
    __pyx_v_stat_list = values[2];
    __pyx_v_box_halfwidths = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_local_stats", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("calc_local_stats.calc_local_stats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box_halfwidths), __pyx_ptype_5numpy_ndarray, 1, "box_halfwidths", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_16calc_local_stats_calc_local_stats(__pyx_self, __pyx_v_input_files, __pyx_v_output_filenames, __pyx_v_stat_list, __pyx_v_box_halfwidths);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_16calc_local_stats_calc_local_stats(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_input_files, PyObject *__pyx_v_output_filenames, PyObject *__pyx_v_stat_list, PyArrayObject *__pyx_v_box_halfwidths) {
  PyObject *__pyx_v_valid_stats = NULL;
  CYTHON_UNUSED double __pyx_v_pix_size_deg;
  double __pyx_v_pix_value;
  long __pyx_v_num_pix_horiz;
  long __pyx_v_num_pix_vert;
  long __pyx_v_upper_index;
  long __pyx_v_lower_index;
  long __pyx_v_left_index;
  long __pyx_v_right_index;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  PyArrayObject *__pyx_v_fits_data = 0;
  PyArrayObject *__pyx_v_local_data = 0;
  PyArrayObject *__pyx_v_local_data_flat = 0;
  PyArrayObject *__pyx_v_local_data_no_nan = 0;
  int __pyx_v_num_files;
  PyArrayObject *__pyx_v_skew_arr = 0;
  PyArrayObject *__pyx_v_kurt_arr = 0;
  PyObject *__pyx_v_fits_file = NULL;
  PyObject *__pyx_v_fits_hdr = NULL;
  PyObject *__pyx_v_NaN_position = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_skew_FITS = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_stat_FITS = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_halfwidths;
  __Pyx_Buffer __pyx_pybuffer_box_halfwidths;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_fits_data;
  __Pyx_Buffer __pyx_pybuffer_fits_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kurt_arr;
  __Pyx_Buffer __pyx_pybuffer_kurt_arr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_local_data;
  __Pyx_Buffer __pyx_pybuffer_local_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_local_data_flat;
  __Pyx_Buffer __pyx_pybuffer_local_data_flat;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_local_data_no_nan;
  __Pyx_Buffer __pyx_pybuffer_local_data_no_nan;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_skew_arr;
  __Pyx_Buffer __pyx_pybuffer_skew_arr;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_local_stats", 0);
  __pyx_pybuffer_fits_data.pybuffer.buf = NULL;
  __pyx_pybuffer_fits_data.refcount = 0;
  __pyx_pybuffernd_fits_data.data = NULL;
  __pyx_pybuffernd_fits_data.rcbuffer = &amp;__pyx_pybuffer_fits_data;
  __pyx_pybuffer_local_data.pybuffer.buf = NULL;
  __pyx_pybuffer_local_data.refcount = 0;
  __pyx_pybuffernd_local_data.data = NULL;
  __pyx_pybuffernd_local_data.rcbuffer = &amp;__pyx_pybuffer_local_data;
  __pyx_pybuffer_local_data_flat.pybuffer.buf = NULL;
  __pyx_pybuffer_local_data_flat.refcount = 0;
  __pyx_pybuffernd_local_data_flat.data = NULL;
  __pyx_pybuffernd_local_data_flat.rcbuffer = &amp;__pyx_pybuffer_local_data_flat;
  __pyx_pybuffer_local_data_no_nan.pybuffer.buf = NULL;
  __pyx_pybuffer_local_data_no_nan.refcount = 0;
  __pyx_pybuffernd_local_data_no_nan.data = NULL;
  __pyx_pybuffernd_local_data_no_nan.rcbuffer = &amp;__pyx_pybuffer_local_data_no_nan;
  __pyx_pybuffer_skew_arr.pybuffer.buf = NULL;
  __pyx_pybuffer_skew_arr.refcount = 0;
  __pyx_pybuffernd_skew_arr.data = NULL;
  __pyx_pybuffernd_skew_arr.rcbuffer = &amp;__pyx_pybuffer_skew_arr;
  __pyx_pybuffer_kurt_arr.pybuffer.buf = NULL;
  __pyx_pybuffer_kurt_arr.refcount = 0;
  __pyx_pybuffernd_kurt_arr.data = NULL;
  __pyx_pybuffernd_kurt_arr.rcbuffer = &amp;__pyx_pybuffer_kurt_arr;
  __pyx_pybuffer_box_halfwidths.pybuffer.buf = NULL;
  __pyx_pybuffer_box_halfwidths.refcount = 0;
  __pyx_pybuffernd_box_halfwidths.data = NULL;
  __pyx_pybuffernd_box_halfwidths.rcbuffer = &amp;__pyx_pybuffer_box_halfwidths;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_box_halfwidths, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_halfwidths.diminfo[0].strides = __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_box_halfwidths.diminfo[0].shape = __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("calc_local_stats.calc_local_stats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_stats);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_fits_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_local_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_local_data_flat);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_local_data_no_nan);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_skew_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kurt_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fits_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fits_hdr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_NaN_position);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_skew_FITS);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stat_FITS);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(28, __pyx_n_s_input_files, __pyx_n_s_output_filenames, __pyx_n_s_stat_list, __pyx_n_s_box_halfwidths, __pyx_n_s_valid_stats, __pyx_n_s_pix_size_deg, __pyx_n_s_pix_value, __pyx_n_s_num_pix_horiz, __pyx_n_s_num_pix_vert, __pyx_n_s_upper_index, __pyx_n_s_lower_index, __pyx_n_s_left_index, __pyx_n_s_right_index, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_fits_data, __pyx_n_s_local_data, __pyx_n_s_local_data_flat, __pyx_n_s_local_data_no_nan, __pyx_n_s_num_files, __pyx_n_s_skew_arr, __pyx_n_s_kurt_arr, __pyx_n_s_fits_file, __pyx_n_s_fits_hdr, __pyx_n_s_NaN_position, __pyx_n_s_skew_FITS, __pyx_n_s_stat_FITS);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_16calc_local_stats_1calc_local_stats, NULL, __pyx_n_s_calc_local_stats);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calc_local_stats, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;038:  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">box_halfwidths</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;039: 	<span class="sd">&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;040: <span class="sd">	Description</span></pre>
<pre class='cython line score-0'>&#xA0;041: <span class="sd">        This function calculates statistics for each pixel in an image, using</span></pre>
<pre class='cython line score-0'>&#xA0;042: <span class="sd">        the data in surrounding pixels. The statistics that are calculated can </span></pre>
<pre class='cython line score-0'>&#xA0;043: <span class="sd">        be specified in the stat_list variable. All of these statistics will</span></pre>
<pre class='cython line score-0'>&#xA0;044: <span class="sd">        be calculated for each input image. Multiple input files can be </span></pre>
<pre class='cython line score-0'>&#xA0;045: <span class="sd">        provided, and statistics will be calculated for each image. Maps of the</span></pre>
<pre class='cython line score-0'>&#xA0;046: <span class="sd">        produced statistics will be saved using the given output filenames.</span></pre>
<pre class='cython line score-0'>&#xA0;047: <span class="sd">        </span></pre>
<pre class='cython line score-0'>&#xA0;048: <span class="sd">    Required Input</span></pre>
<pre class='cython line score-0'>&#xA0;049: <span class="sd">        input_files - An array of strings, where each string specifies the </span></pre>
<pre class='cython line score-0'>&#xA0;050: <span class="sd">        			  directory and filename of the FITS image to calculate </span></pre>
<pre class='cython line score-0'>&#xA0;051: <span class="sd">        			  statistics for. Local statistics are calculated for each</span></pre>
<pre class='cython line score-0'>&#xA0;052: <span class="sd">        			  file provided in this array.</span></pre>
<pre class='cython line score-0'>&#xA0;053: <span class="sd">        output_filenames - An array of strings, where each string specifies the </span></pre>
<pre class='cython line score-0'>&#xA0;054: <span class="sd">        				   directory and filename to use when saving a FITS </span></pre>
<pre class='cython line score-0'>&#xA0;055: <span class="sd">        				   file image of the produced statistic map. An image is</span></pre>
<pre class='cython line score-0'>&#xA0;056: <span class="sd">        				   saved for each input file, and each statistic. This</span></pre>
<pre class='cython line score-0'>&#xA0;057: <span class="sd">        				   array needs to be the same length as input_files.</span></pre>
<pre class='cython line score-0'>&#xA0;058: <span class="sd">        				   Each FITS file that is saved will have the type of </span></pre>
<pre class='cython line score-0'>&#xA0;059: <span class="sd">        				   statistic appended to the output filename provided.</span></pre>
<pre class='cython line score-0'>&#xA0;060: <span class="sd">        				   The given strings should not have the .fits extension</span></pre>
<pre class='cython line score-0'>&#xA0;061: <span class="sd">        				   present, as this is added in the function.</span></pre>
<pre class='cython line score-0'>&#xA0;062: <span class="sd">        stat_list - An array of strings, where each string specifies a statistic</span></pre>
<pre class='cython line score-0'>&#xA0;063: <span class="sd">        			that is to be calculated locally for each input image.</span></pre>
<pre class='cython line score-0'>&#xA0;064: <span class="sd">        			Allowed values are &#39;skewness&#39; and &#39;kurtosis&#39;.</span></pre>
<pre class='cython line score-0'>&#xA0;065: <span class="sd">        box_halfwidths - The half-widths of the box to use when calculating the</span></pre>
<pre class='cython line score-0'>&#xA0;066: <span class="sd">        				 local statistics, in pixels. This is an array of</span></pre>
<pre class='cython line score-0'>&#xA0;067: <span class="sd">        				 positive integers greater than or equal to 1. This </span></pre>
<pre class='cython line score-0'>&#xA0;068: <span class="sd">        				 array must have the same length as input_files. </span></pre>
<pre class='cython line score-0'>&#xA0;069: <span class="sd">                   </span></pre>
<pre class='cython line score-0'>&#xA0;070: <span class="sd">    Output</span></pre>
<pre class='cython line score-0'>&#xA0;071: <span class="sd">        0 - An error occurred, possibly due to inappropriate input values</span></pre>
<pre class='cython line score-0'>&#xA0;072: <span class="sd">        1 - Function ran to completion, and saved FITS images of the calculated</span></pre>
<pre class='cython line score-0'>&#xA0;073: <span class="sd">        	statistics maps successfully.</span></pre>
<pre class='cython line score-0'>&#xA0;074: <span class="sd">	&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;075: </pre>
<pre class='cython line score-0'>&#xA0;076: 	<span class="c"># Check to see that the number of output filenames matches the number of</span></pre>
<pre class='cython line score-0'>&#xA0;077: 	<span class="c"># input filenames</span></pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+078: 	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_files</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">):</span></pre>
<pre class='cython code score-10'>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_input_files);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_output_filenames);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((__pyx_t_1 != __pyx_t_2) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;079: 		<span class="c"># In this case the number of output filenames does not match the number</span></pre>
<pre class='cython line score-0'>&#xA0;080: 		<span class="c"># input filenames, so the code cannot proceed. Print an error message</span></pre>
<pre class='cython line score-0'>&#xA0;081: 		<span class="c"># to say what has happened</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+082: 		<span class="k">print</span> <span class="s">&#39;ERROR: Number of input files and output filenames are different&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_ERROR_Number_of_input_files_and) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;083: </pre>
<pre class='cython line score-0'>&#xA0;084: 		<span class="c"># The code should not proceed in this case, so return 0</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+085: 		<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;086: </pre>
<pre class='cython line score-0'>&#xA0;087: 	<span class="c"># Check to see that the number of box halfwidth values equals the number</span></pre>
<pre class='cython line score-0'>&#xA0;088: 	<span class="c"># of input filenames</span></pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+089: 	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_files</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">box_halfwidths</span><span class="p">):</span></pre>
<pre class='cython code score-10'>  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_input_files);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_box_halfwidths));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((__pyx_t_2 != __pyx_t_1) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;090: 		<span class="c"># In this case the number of box halfwidths to use does not match the</span></pre>
<pre class='cython line score-0'>&#xA0;091: 		<span class="c"># number of input filenames, so the code cannot proceed. Print an </span></pre>
<pre class='cython line score-0'>&#xA0;092: 		<span class="c"># error message to say what has happened.</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+093: 		<span class="k">print</span> <span class="s">&#39;ERROR: Number of input files and box halfwidths are different&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_ERROR_Number_of_input_files_and_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;094: </pre>
<pre class='cython line score-0'>&#xA0;095: 		<span class="c"># The code should not proceed in this case, so return 0</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+096: 		<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;097: </pre>
<pre class='cython line score-0'>&#xA0;098: 	<span class="c"># Create a list of valid strings that can be given to the stat_list variable</span></pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+099: 	<span class="n">valid_stats</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;skewness&#39;</span><span class="p">,</span> <span class="s">&#39;kurtosis&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-9'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_skewness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_skewness);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_skewness);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_kurtosis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_kurtosis);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_n_s_kurtosis);
  __pyx_v_valid_stats = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;100: </pre>
<pre class='cython line score-0'>&#xA0;101: 	<span class="c"># Check to see that valid statistics were provided</span></pre>
<pre class='cython line score-40' onclick='toggleDiv(this)'>+102: 	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">valid_stats</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">stat_list</span><span class="p">)))</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-40'>  __pyx_t_5 = <span class='py_c_api'>PySet_New</span>(__pyx_v_valid_stats);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intersection);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_stat_list);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_stat_list);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_stat_list);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_stat_list);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_3 = ((__pyx_t_1 == 0) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;103: 		<span class="c"># In this case the array of strings given to the function does not</span></pre>
<pre class='cython line score-0'>&#xA0;104: 		<span class="c"># provide any valid statistics to calculate, so print an error message</span></pre>
<pre class='cython line score-0'>&#xA0;105: 		<span class="c"># to the screen</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+106: 		<span class="k">print</span> <span class="s">&#39;ERROR: No valid statistics provided to the function&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_ERROR_No_valid_statistics_provid) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;107: </pre>
<pre class='cython line score-0'>&#xA0;108: 		<span class="c"># The code should not proceed in this case, so return 0</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+109: 		<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;110: </pre>
<pre class='cython line score-0'>&#xA0;111: 	<span class="c"># Check to see that the values given for the box halfwidths are positive</span></pre>
<pre class='cython line score-0'>&#xA0;112: 	<span class="c"># integers greater than or equal to 1</span></pre>
<pre class='cython line score-37' onclick='toggleDiv(this)'>+113: 	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">box_halfwidths</span> <span class="o">&lt;</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-37'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_box_halfwidths), __pyx_int_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;114: 		<span class="c"># In this case a value given for the box halfwidth is invalid, so</span></pre>
<pre class='cython line score-0'>&#xA0;115: 		<span class="c"># print an error message to the screen</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+116: 		<span class="k">print</span> <span class="s">&#39;ERROR: At least one of the values for box half-width is invalid&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_ERROR_At_least_one_of_the_values) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;117: </pre>
<pre class='cython line score-0'>&#xA0;118: 		<span class="c"># The code should not proceed in this case, so return to 0</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+119: 		<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;120: </pre>
<pre class='cython line score-0'>&#xA0;121: 	<span class="c"># Before looping over all of the input files, define the numerical variables</span></pre>
<pre class='cython line score-0'>&#xA0;122: 	<span class="c"># that will be used in calculations</span></pre>
<pre class='cython line score-0'>&#xA0;123: 	<span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;124: 		<span class="n">double</span> <span class="n">pix_size_deg</span><span class="p">,</span> <span class="n">pix_value</span></pre>
<pre class='cython line score-0'>&#xA0;125: 		<span class="nb">long</span> <span class="n">num_pix_horiz</span><span class="p">,</span> <span class="n">num_pix_vert</span></pre>
<pre class='cython line score-0'>&#xA0;126: 		<span class="nb">long</span> <span class="n">upper_index</span><span class="p">,</span> <span class="n">lower_index</span><span class="p">,</span> <span class="n">left_index</span><span class="p">,</span> <span class="n">right_index</span></pre>
<pre class='cython line score-0'>&#xA0;127: 		<span class="nb">long</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span></pre>
<pre class='cython line score-0'>&#xA0;128: 		<span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">fits_data</span><span class="p">,</span> <span class="n">local_data</span></pre>
<pre class='cython line score-0'>&#xA0;129: 		<span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">local_data_flat</span><span class="p">,</span> <span class="n">local_data_no_nan</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+130: 		<span class="nb">int</span> <span class="n">num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_files</span><span class="p">)</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_input_files);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_num_files = __pyx_t_1;
</pre><pre class='cython line score-0'>&#xA0;131: </pre>
<pre class='cython line score-0'>&#xA0;132: 	<span class="c"># Declare Numpy arrays that will be used to hold the calculated statistics</span></pre>
<pre class='cython line score-0'>&#xA0;133: 	<span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;134: 		<span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">skew_arr</span><span class="p">,</span> <span class="n">kurt_arr</span></pre>
<pre class='cython line score-0'>&#xA0;135: </pre>
<pre class='cython line score-0'>&#xA0;136: 	<span class="c"># Loop over the given input files, so that we can calculate statistics for</span></pre>
<pre class='cython line score-0'>&#xA0;137: 	<span class="c"># each one</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+138: 	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_files</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = __pyx_v_num_files;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class='cython line score-0'>&#xA0;139: 		<span class="c"># Print a message to show that calculations are starting for the current</span></pre>
<pre class='cython line score-0'>&#xA0;140: 		<span class="c"># input file</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+141: 		<span class="k">print</span> <span class="s">&#39;Calculations starting for {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-31'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Calculations_starting_for, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_files, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    } else {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;142: </pre>
<pre class='cython line score-0'>&#xA0;143: 		<span class="c"># Open the CGPS FITS file for the current resolution</span></pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+144: 		<span class="n">fits_file</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">input_files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-32'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fits);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_open);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_files, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_fits_file, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;145: </pre>
<pre class='cython line score-0'>&#xA0;146: 		<span class="c"># Obtain the header of the primary HDU for the data</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+147: 		<span class="n">fits_hdr</span> <span class="o">=</span> <span class="n">fits_file</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span></pre>
<pre class='cython code score-6'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_fits_file, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_header);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_fits_hdr, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;148: </pre>
<pre class='cython line score-0'>&#xA0;149: 		<span class="c"># Extract the data from the FITS file, which is held in the primary HDU</span></pre>
<pre class='cython line score-64' onclick='toggleDiv(this)'>+150: 		<span class="n">fits_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span><span class="o">.</span><span class="n">newbyteorder</span><span class="p">()</span></pre>
<pre class='cython code score-64'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_fits_file, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_byteswap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_newbyteorder);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (__pyx_t_6) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_fits_data, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
        }
      }
      __pyx_pybuffernd_fits_data.diminfo[0].strides = __pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_fits_data.diminfo[0].shape = __pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_fits_data.diminfo[1].strides = __pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_fits_data.diminfo[1].shape = __pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_fits_data, ((PyArrayObject *)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;151: </pre>
<pre class='cython line score-0'>&#xA0;152: 		<span class="c"># Print a message to the screen saying that the data was successfully </span></pre>
<pre class='cython line score-0'>&#xA0;153: 		<span class="c"># extracted</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+154: 		<span class="k">print</span> <span class="s">&#39;CGPS data successfully extracted from the FITS file.&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_CGPS_data_successfully_extracted) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;155: </pre>
<pre class='cython line score-0'>&#xA0;156: 		<span class="c"># Initialise the statistics arrays</span></pre>
<pre class='cython line score-79' onclick='toggleDiv(this)'>+157: 		<span class="n">skew_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">fits_data</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-79'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_fits_data));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_fits_data));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_fits_data));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, ((PyObject *)__pyx_v_fits_data));
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_16 = ((PyArrayObject *)__pyx_t_8);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_skew_arr, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
        }
      }
      __pyx_pybuffernd_skew_arr.diminfo[0].strides = __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_skew_arr.diminfo[0].shape = __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_skew_arr.diminfo[1].strides = __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_skew_arr.diminfo[1].shape = __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_skew_arr, ((PyArrayObject *)__pyx_t_8));
    __pyx_t_8 = 0;
</pre><pre class='cython line score-79' onclick='toggleDiv(this)'>+158: 		<span class="n">kurt_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">fits_data</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-79'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_fits_data));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_fits_data));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_fits_data));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_fits_data));
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_16 = ((PyArrayObject *)__pyx_t_6);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kurt_arr, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
        }
      }
      __pyx_pybuffernd_kurt_arr.diminfo[0].strides = __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kurt_arr.diminfo[0].shape = __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kurt_arr.diminfo[1].strides = __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kurt_arr.diminfo[1].shape = __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_kurt_arr, ((PyArrayObject *)__pyx_t_6));
    __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;159: </pre>
<pre class='cython line score-0'>&#xA0;160: 		<span class="c"># # Create a dictionary that will hold the arrays corresponding to each </span></pre>
<pre class='cython line score-0'>&#xA0;161: 		<span class="c"># # statistic</span></pre>
<pre class='cython line score-0'>&#xA0;162: 		<span class="c"># stat_dict = {}</span></pre>
<pre class='cython line score-0'>&#xA0;163: </pre>
<pre class='cython line score-0'>&#xA0;164: 		<span class="c"># # Create new numpy arrays, that have the same size as the input array. </span></pre>
<pre class='cython line score-0'>&#xA0;165: 		<span class="c"># # These will be used to store the calculated local statistics. The </span></pre>
<pre class='cython line score-0'>&#xA0;166: 		<span class="c"># # arrays are stored in a dictionary, with each statistic having its own </span></pre>
<pre class='cython line score-0'>&#xA0;167: 		<span class="c"># # array</span></pre>
<pre class='cython line score-0'>&#xA0;168: 		<span class="c"># for stat in stat_list:</span></pre>
<pre class='cython line score-0'>&#xA0;169: 		<span class="c"># 	# Assign an empty array to the current statistic. Note that the data</span></pre>
<pre class='cython line score-0'>&#xA0;170: 		<span class="c"># 	# type is 32-bit float, since all of the input arrays have that data</span></pre>
<pre class='cython line score-0'>&#xA0;171: 		<span class="c"># 	# type</span></pre>
<pre class='cython line score-0'>&#xA0;172: 		<span class="c"># 	stat_dict[stat] = np.zeros(np.shape(fits_data), dtype = DTYPE)</span></pre>
<pre class='cython line score-0'>&#xA0;173: </pre>
<pre class='cython line score-0'>&#xA0;174: 		<span class="c"># Extract the size of each pixel from the header. This is the length of </span></pre>
<pre class='cython line score-0'>&#xA0;175: 		<span class="c"># each side of the pixel (assumed to be square), in degrees. </span></pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+176: 		<span class="n">pix_size_deg</span> <span class="o">=</span> <span class="n">fits_hdr</span><span class="p">[</span><span class="s">&#39;CDELT2&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-11'>    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fits_hdr, __pyx_n_s_CDELT2);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_17 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_17 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_pix_size_deg = __pyx_t_17;
</pre><pre class='cython line score-0'>&#xA0;177: </pre>
<pre class='cython line score-0'>&#xA0;178: 		<span class="c"># Extract the number of pixels along the horizontal axis of the image</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+179: 		<span class="n">num_pix_horiz</span> <span class="o">=</span> <span class="n">fits_hdr</span><span class="p">[</span><span class="s">&#39;NAXIS1&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-8'>    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fits_hdr, __pyx_n_s_NAXIS1);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_18 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_num_pix_horiz = __pyx_t_18;
</pre><pre class='cython line score-0'>&#xA0;180: </pre>
<pre class='cython line score-0'>&#xA0;181: 		<span class="c"># Extract the number of pixels along the vertical axis of the image</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+182: 		<span class="n">num_pix_vert</span> <span class="o">=</span> <span class="n">fits_hdr</span><span class="p">[</span><span class="s">&#39;NAXIS2&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-8'>    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fits_hdr, __pyx_n_s_NAXIS2);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_18 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_num_pix_vert = __pyx_t_18;
</pre><pre class='cython line score-0'>&#xA0;183: </pre>
<pre class='cython line score-0'>&#xA0;184: 		<span class="c"># Loop over all of the pixels in the dataset, starting by looping over </span></pre>
<pre class='cython line score-0'>&#xA0;185: 		<span class="c"># each row</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+186: 		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pix_vert</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_num_pix_vert;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
      __pyx_v_j = __pyx_t_19;
</pre><pre class='cython line score-0'>&#xA0;187: 			<span class="c"># Loop over all of the pixels in this row</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+188: 			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pix_horiz</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_20 = __pyx_v_num_pix_horiz;
      for (__pyx_t_21 = 0; __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
        __pyx_v_k = __pyx_t_21;
</pre><pre class='cython line score-0'>&#xA0;189: 				<span class="c"># Extract the value of the data at the current pixel</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+190: 				<span class="n">pix_value</span> <span class="o">=</span> <span class="n">fits_data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_22 = __pyx_v_j;
        __pyx_t_23 = __pyx_v_k;
        __pyx_t_12 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_fits_data.diminfo[0].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_fits_data.diminfo[0].shape)) __pyx_t_12 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_pybuffernd_fits_data.diminfo[1].shape;
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_12 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_pybuffernd_fits_data.diminfo[1].shape)) __pyx_t_12 = 1;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_pix_value = (*__Pyx_BufPtrStrided2d(__pyx_t_16calc_local_stats_DTYPE_t *, __pyx_pybuffernd_fits_data.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_fits_data.diminfo[0].strides, __pyx_t_23, __pyx_pybuffernd_fits_data.diminfo[1].strides));
</pre><pre class='cython line score-0'>&#xA0;191: </pre>
<pre class='cython line score-0'>&#xA0;192: 				<span class="c"># Calculate the index of the uppermost pixels to be included in </span></pre>
<pre class='cython line score-0'>&#xA0;193: 				<span class="c"># the local box. Note that the minus sign is because Python </span></pre>
<pre class='cython line score-0'>&#xA0;194: 				<span class="c"># indexes so that the pixels highest in the image have the </span></pre>
<pre class='cython line score-0'>&#xA0;195: 				<span class="c"># lowest index value</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+196: 				<span class="n">upper_index</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">box_halfwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_24 = __pyx_v_i;
        __pyx_t_12 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_pybuffernd_box_halfwidths.diminfo[0].shape;
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_pybuffernd_box_halfwidths.diminfo[0].shape)) __pyx_t_12 = 0;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_upper_index = (__pyx_v_j - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box_halfwidths.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;197: </pre>
<pre class='cython line score-0'>&#xA0;198: 				<span class="c"># Calculate the index of the lowermost pixels to be included in </span></pre>
<pre class='cython line score-0'>&#xA0;199: 				<span class="c"># the local box</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+200: 				<span class="n">lower_index</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">box_halfwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_25 = __pyx_v_i;
        __pyx_t_12 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_pybuffernd_box_halfwidths.diminfo[0].shape;
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_pybuffernd_box_halfwidths.diminfo[0].shape)) __pyx_t_12 = 0;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_lower_index = (__pyx_v_j + (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_box_halfwidths.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;201: </pre>
<pre class='cython line score-0'>&#xA0;202: 				<span class="c"># Calculate the index of the rightmost pixels to be included in </span></pre>
<pre class='cython line score-0'>&#xA0;203: 				<span class="c"># the local box</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+204: 				<span class="n">right_index</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">box_halfwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_26 = __pyx_v_i;
        __pyx_t_12 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_pybuffernd_box_halfwidths.diminfo[0].shape;
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_pybuffernd_box_halfwidths.diminfo[0].shape)) __pyx_t_12 = 0;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_right_index = (__pyx_v_k + (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_box_halfwidths.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;205: </pre>
<pre class='cython line score-0'>&#xA0;206: 				<span class="c"># Calculate the index of the leftmost pixels to be included in </span></pre>
<pre class='cython line score-0'>&#xA0;207: 				<span class="c"># the local box</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+208: 				<span class="n">left_index</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">box_halfwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_27 = __pyx_v_i;
        __pyx_t_12 = -1;
        if (__pyx_t_27 &lt; 0) {
          __pyx_t_27 += __pyx_pybuffernd_box_halfwidths.diminfo[0].shape;
          if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_27 &gt;= __pyx_pybuffernd_box_halfwidths.diminfo[0].shape)) __pyx_t_12 = 0;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_left_index = (__pyx_v_k - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_box_halfwidths.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_box_halfwidths.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;209: </pre>
<pre class='cython line score-0'>&#xA0;210: 				<span class="c"># Check that the index of the uppermost pixel to include in the</span></pre>
<pre class='cython line score-0'>&#xA0;211: 				<span class="c"># local box is valid, i.e. not negative</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+212: 				<span class="k">if</span> <span class="n">upper_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((__pyx_v_upper_index &lt; 0) != 0);
        if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;213: 					<span class="c"># In this case the value of the upper index doesn&#39;t make </span></pre>
<pre class='cython line score-0'>&#xA0;214: 					<span class="c"># sense, so reset it to zero</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+215: 					<span class="n">upper_index</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_v_upper_index = 0;
          goto __pyx_L13;
        }
        __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;216: </pre>
<pre class='cython line score-0'>&#xA0;217: 				<span class="c"># Check that the index of the leftmost pixel to include in the </span></pre>
<pre class='cython line score-0'>&#xA0;218: 				<span class="c"># local box is valid, i.e. not negative</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+219: 				<span class="k">if</span> <span class="n">left_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((__pyx_v_left_index &lt; 0) != 0);
        if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;220: 					<span class="c"># In this case the value of the left index doesn&#39;t make </span></pre>
<pre class='cython line score-0'>&#xA0;221: 					<span class="c"># sense, so reset it to zero</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+222: 					<span class="n">left_index</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_v_left_index = 0;
          goto __pyx_L14;
        }
        __pyx_L14:;
</pre><pre class='cython line score-0'>&#xA0;223: </pre>
<pre class='cython line score-0'>&#xA0;224: 				<span class="c"># Check that the index of the lowermost pixel to include in the</span></pre>
<pre class='cython line score-0'>&#xA0;225: 				<span class="c"># local box is valid, i.e. that it does not extend beyond the</span></pre>
<pre class='cython line score-0'>&#xA0;226: 				<span class="c"># boundaries of the image</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+227: 				<span class="k">if</span> <span class="n">lower_index</span> <span class="o">&gt;=</span> <span class="n">num_pix_vert</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((__pyx_v_lower_index &gt;= __pyx_v_num_pix_vert) != 0);
        if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;228: 					<span class="c"># In this case the value of the lower index doesn&#39;t make </span></pre>
<pre class='cython line score-0'>&#xA0;229: 					<span class="c"># sense, so reset it to the largest possible index for the </span></pre>
<pre class='cython line score-0'>&#xA0;230: 					<span class="c"># vertical axis</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+231: 					<span class="n">lower_index</span> <span class="o">=</span> <span class="n">num_pix_vert</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>          __pyx_v_lower_index = (__pyx_v_num_pix_vert - 1);
          goto __pyx_L15;
        }
        __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;232: </pre>
<pre class='cython line score-0'>&#xA0;233: 				<span class="c"># Check that the index of the rightmost pixel to include in the</span></pre>
<pre class='cython line score-0'>&#xA0;234: 				<span class="c"># local box is valid, i.e. that it does not extend beyond the</span></pre>
<pre class='cython line score-0'>&#xA0;235: 				<span class="c"># boundaries of the image</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+236: 				<span class="k">if</span> <span class="n">right_index</span> <span class="o">&gt;=</span> <span class="n">num_pix_horiz</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((__pyx_v_right_index &gt;= __pyx_v_num_pix_horiz) != 0);
        if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;237: 					<span class="c"># In this case the value of the lower index doesn&#39;t make </span></pre>
<pre class='cython line score-0'>&#xA0;238: 					<span class="c"># sense, so reset it to the largest possible index for the </span></pre>
<pre class='cython line score-0'>&#xA0;239: 					<span class="c"># horizontal axis</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+240: 					<span class="n">right_index</span> <span class="o">=</span> <span class="n">num_pix_horiz</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>          __pyx_v_right_index = (__pyx_v_num_pix_horiz - 1);
          goto __pyx_L16;
        }
        __pyx_L16:;
</pre><pre class='cython line score-0'>&#xA0;241: </pre>
<pre class='cython line score-0'>&#xA0;242: 				<span class="c"># Check to see if the value of the data at this pixel is NaN</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+243: 				<span class="k">if</span> <span class="n">isnan</span><span class="p">(</span><span class="n">pix_value</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((isnan(__pyx_v_pix_value) != 0) != 0);
        if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;244: 					<span class="c"># In this case the pixel is NaN, so set the corresponding </span></pre>
<pre class='cython line score-0'>&#xA0;245: 					<span class="c"># pixel in all of the statistics arrays to NaN as well</span></pre>
<pre class='cython line score-0'>&#xA0;246: 					<span class="c"># for stat in stat_list:</span></pre>
<pre class='cython line score-0'>&#xA0;247: 					<span class="c"># 	(stat_dict[stat])[j,k] = NAN</span></pre>
<pre class='cython line score-0'>&#xA0;248: 					<span class="c"># Check to see if the skewness of the local area needs to be</span></pre>
<pre class='cython line score-0'>&#xA0;249: 					<span class="c"># calculated</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+250: 					<span class="k">if</span> <span class="s">&#39;skewness&#39;</span> <span class="ow">in</span> <span class="n">stat_list</span><span class="p">:</span></pre>
<pre class='cython code score-2'>          __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_n_s_skewness, __pyx_v_stat_list, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_28 = (__pyx_t_3 != 0);
          if (__pyx_t_28) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+251: 						<span class="n">skew_arr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-2'>            __pyx_t_29 = __pyx_v_j;
            __pyx_t_30 = __pyx_v_k;
            __pyx_t_12 = -1;
            if (__pyx_t_29 &lt; 0) {
              __pyx_t_29 += __pyx_pybuffernd_skew_arr.diminfo[0].shape;
              if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_12 = 0;
            } else if (unlikely(__pyx_t_29 &gt;= __pyx_pybuffernd_skew_arr.diminfo[0].shape)) __pyx_t_12 = 0;
            if (__pyx_t_30 &lt; 0) {
              __pyx_t_30 += __pyx_pybuffernd_skew_arr.diminfo[1].shape;
              if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_12 = 1;
            } else if (unlikely(__pyx_t_30 &gt;= __pyx_pybuffernd_skew_arr.diminfo[1].shape)) __pyx_t_12 = 1;
            if (unlikely(__pyx_t_12 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
              <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_16calc_local_stats_DTYPE_t *, __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_skew_arr.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_skew_arr.diminfo[1].strides) = NAN;
            goto __pyx_L18;
          }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+252: 					<span class="k">elif</span> <span class="s">&#39;kurtosis&#39;</span> <span class="ow">in</span> <span class="n">stat_list</span><span class="p">:</span></pre>
<pre class='cython code score-2'>          __pyx_t_28 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_n_s_kurtosis, __pyx_v_stat_list, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_28 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_3 = (__pyx_t_28 != 0);
          if (__pyx_t_3) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+253: 						<span class="n">kurt_arr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-2'>            __pyx_t_31 = __pyx_v_j;
            __pyx_t_32 = __pyx_v_k;
            __pyx_t_12 = -1;
            if (__pyx_t_31 &lt; 0) {
              __pyx_t_31 += __pyx_pybuffernd_kurt_arr.diminfo[0].shape;
              if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_12 = 0;
            } else if (unlikely(__pyx_t_31 &gt;= __pyx_pybuffernd_kurt_arr.diminfo[0].shape)) __pyx_t_12 = 0;
            if (__pyx_t_32 &lt; 0) {
              __pyx_t_32 += __pyx_pybuffernd_kurt_arr.diminfo[1].shape;
              if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_12 = 1;
            } else if (unlikely(__pyx_t_32 &gt;= __pyx_pybuffernd_kurt_arr.diminfo[1].shape)) __pyx_t_12 = 1;
            if (unlikely(__pyx_t_12 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
              <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_16calc_local_stats_DTYPE_t *, __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_kurt_arr.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_kurt_arr.diminfo[1].strides) = NAN;
            goto __pyx_L18;
          }
          __pyx_L18:;
          goto __pyx_L17;
        }
        /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;254: </pre>
<pre class='cython line score-0'>&#xA0;255: 				<span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;256: 					<span class="c"># In this case the pixel is not NaN, and so we can calculate </span></pre>
<pre class='cython line score-0'>&#xA0;257: 					<span class="c"># local statistics at this point</span></pre>
<pre class='cython line score-0'>&#xA0;258: </pre>
<pre class='cython line score-0'>&#xA0;259: 					<span class="c"># Extract the data in the local box around the current</span></pre>
<pre class='cython line score-0'>&#xA0;260: 					<span class="c"># pixel we are studying</span></pre>
<pre class='cython line score-52' onclick='toggleDiv(this)'>+261: 					<span class="n">local_data</span> <span class="o">=</span> <span class="n">fits_data</span><span class="p">[</span><span class="n">upper_index</span><span class="p">:</span><span class="n">lower_index</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span>\</pre>
<pre class='cython code score-52'>          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_upper_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_lower_index + 1));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_4 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_6, __pyx_t_8, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
          __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_8, __pyx_t_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
          __pyx_t_4 = 0;
          __pyx_t_5 = 0;
          __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_fits_data), __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
          {
            __Pyx_BufFmt_StackElem __pyx_stack[1];
            <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer);
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
            if (unlikely(__pyx_t_12 &lt; 0)) {
              <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
              if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_local_data, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
                Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
                <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
              } else {
                <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
              }
            }
            __pyx_pybuffernd_local_data.diminfo[0].strides = __pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_local_data.diminfo[0].shape = __pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_local_data.diminfo[1].strides = __pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_local_data.diminfo[1].shape = __pyx_pybuffernd_local_data.rcbuffer-&gt;pybuffer.shape[1];
            if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_local_data, ((PyArrayObject *)__pyx_t_5));
          __pyx_t_5 = 0;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+262: 					 <span class="n">left_index</span><span class="p">:</span><span class="n">right_index</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-4'>          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_left_index);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_right_index + 1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-0'>&#xA0;263: </pre>
<pre class='cython line score-0'>&#xA0;264: 					<span class="c"># Check to see if the skewness of the local area needs to be</span></pre>
<pre class='cython line score-0'>&#xA0;265: 					<span class="c"># calculated</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+266: 					<span class="k">if</span> <span class="s">&#39;skewness&#39;</span> <span class="ow">in</span> <span class="n">stat_list</span><span class="p">:</span></pre>
<pre class='cython code score-2'>          __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_n_s_skewness, __pyx_v_stat_list, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_28 = (__pyx_t_3 != 0);
          if (__pyx_t_28) {
</pre><pre class='cython line score-0'>&#xA0;267: 						<span class="c"># Flatten the local data into a one-dimensional array</span></pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+268: 						<span class="n">local_data_flat</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-39'>            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_local_data), __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_4 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
              __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
              if (likely(__pyx_t_4)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
              }
            }
            if (__pyx_t_4) {
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            } else {
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            __pyx_t_33 = ((PyArrayObject *)__pyx_t_5);
            {
              __Pyx_BufFmt_StackElem __pyx_stack[1];
              <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_33, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
              if (unlikely(__pyx_t_12 &lt; 0)) {
                <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
                if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_local_data_flat, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
                  Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
                  <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
                } else {
                  <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
                }
              }
              __pyx_pybuffernd_local_data_flat.diminfo[0].strides = __pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_local_data_flat.diminfo[0].shape = __pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer.shape[0];
              if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_33 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_local_data_flat, ((PyArrayObject *)__pyx_t_5));
            __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;269: </pre>
<pre class='cython line score-0'>&#xA0;270: 						<span class="c"># Find where all of the NaN values are in the local data</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+271: 						<span class="n">NaN_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">local_data_flat</span><span class="p">)</span></pre>
<pre class='cython code score-30'>            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_6 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
              __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
              if (likely(__pyx_t_6)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
              }
            }
            if (!__pyx_t_6) {
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_local_data_flat));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            } else {
              __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_local_data_flat));
              <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_local_data_flat));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, ((PyObject *)__pyx_v_local_data_flat));
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_NaN_position, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;272: </pre>
<pre class='cython line score-0'>&#xA0;273: 						<span class="c"># Extract the values in the local data that are not NaN</span></pre>
<pre class='cython line score-0'>&#xA0;274: 						<span class="n">local_data_no_nan</span> <span class="o">=</span>\</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+275: 						 <span class="n">local_data_flat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">NaN_position</span><span class="p">)]</span></pre>
<pre class='cython code score-56'>            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_logical_not);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
              __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
              if (likely(__pyx_t_4)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
              }
            }
            if (!__pyx_t_4) {
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_NaN_position);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            } else {
              __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_NaN_position);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_NaN_position);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_NaN_position);
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_local_data_flat), __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            __pyx_t_33 = ((PyArrayObject *)__pyx_t_8);
            {
              __Pyx_BufFmt_StackElem __pyx_stack[1];
              <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_33, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
              if (unlikely(__pyx_t_12 &lt; 0)) {
                <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
                if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_local_data_no_nan, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
                  Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
                  <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
                } else {
                  <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
                }
              }
              __pyx_pybuffernd_local_data_no_nan.diminfo[0].strides = __pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_local_data_no_nan.diminfo[0].shape = __pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer.shape[0];
              if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_33 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_local_data_no_nan, ((PyArrayObject *)__pyx_t_8));
            __pyx_t_8 = 0;
</pre><pre class='cython line score-0'>&#xA0;276: </pre>
<pre class='cython line score-0'>&#xA0;277: 						<span class="c"># Calculate the skewness of the local data that has had </span></pre>
<pre class='cython line score-0'>&#xA0;278: 						<span class="c"># the NaN values removed, and store it in the </span></pre>
<pre class='cython line score-0'>&#xA0;279: 						<span class="c"># corresponding array</span></pre>
<pre class='cython line score-0'>&#xA0;280: 						<span class="c"># (stat_dict[&#39;skewness&#39;])[j,k] =\</span></pre>
<pre class='cython line score-0'>&#xA0;281: 						<span class="c">#  stats.skew(local_data_no_nan)</span></pre>
<pre class='cython line score-37' onclick='toggleDiv(this)'>+282: 						<span class="n">skew_arr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">local_data_no_nan</span><span class="p">)</span></pre>
<pre class='cython code score-37'>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_stats);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_skew);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
              __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
              if (likely(__pyx_t_5)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
              }
            }
            if (!__pyx_t_5) {
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, ((PyObject *)__pyx_v_local_data_no_nan));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            } else {
              __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_local_data_no_nan));
              <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_local_data_no_nan));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_local_data_no_nan));
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_34 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_34 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_35 = __pyx_v_j;
            __pyx_t_36 = __pyx_v_k;
            __pyx_t_12 = -1;
            if (__pyx_t_35 &lt; 0) {
              __pyx_t_35 += __pyx_pybuffernd_skew_arr.diminfo[0].shape;
              if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_12 = 0;
            } else if (unlikely(__pyx_t_35 &gt;= __pyx_pybuffernd_skew_arr.diminfo[0].shape)) __pyx_t_12 = 0;
            if (__pyx_t_36 &lt; 0) {
              __pyx_t_36 += __pyx_pybuffernd_skew_arr.diminfo[1].shape;
              if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_12 = 1;
            } else if (unlikely(__pyx_t_36 &gt;= __pyx_pybuffernd_skew_arr.diminfo[1].shape)) __pyx_t_12 = 1;
            if (unlikely(__pyx_t_12 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
              <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_16calc_local_stats_DTYPE_t *, __pyx_pybuffernd_skew_arr.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_skew_arr.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_skew_arr.diminfo[1].strides) = __pyx_t_34;
            goto __pyx_L19;
          }
</pre><pre class='cython line score-0'>&#xA0;283: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+284: 					<span class="k">elif</span> <span class="s">&#39;kurtosis&#39;</span> <span class="ow">in</span> <span class="n">stat_list</span><span class="p">:</span></pre>
<pre class='cython code score-2'>          __pyx_t_28 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_n_s_kurtosis, __pyx_v_stat_list, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_28 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_3 = (__pyx_t_28 != 0);
          if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;285: 						<span class="c"># Flatten the local data into a one-dimensional array</span></pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+286: 						<span class="n">local_data_flat</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-39'>            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_local_data), __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_4 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
              __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
              if (likely(__pyx_t_4)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
              }
            }
            if (__pyx_t_4) {
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            } else {
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            __pyx_t_33 = ((PyArrayObject *)__pyx_t_8);
            {
              __Pyx_BufFmt_StackElem __pyx_stack[1];
              <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_33, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
              if (unlikely(__pyx_t_12 &lt; 0)) {
                <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
                if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_local_data_flat, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
                  Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
                  <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
                } else {
                  <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
                }
              }
              __pyx_pybuffernd_local_data_flat.diminfo[0].strides = __pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_local_data_flat.diminfo[0].shape = __pyx_pybuffernd_local_data_flat.rcbuffer-&gt;pybuffer.shape[0];
              if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_33 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_local_data_flat, ((PyArrayObject *)__pyx_t_8));
            __pyx_t_8 = 0;
</pre><pre class='cython line score-0'>&#xA0;287: </pre>
<pre class='cython line score-0'>&#xA0;288: 						<span class="c"># Find where all of the NaN values are in the local data</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+289: 						<span class="n">NaN_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">local_data_flat</span><span class="p">)</span></pre>
<pre class='cython code score-30'>            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_6 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
              __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
              if (likely(__pyx_t_6)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
              }
            }
            if (!__pyx_t_6) {
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_local_data_flat));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            } else {
              __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_local_data_flat));
              <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_local_data_flat));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_local_data_flat));
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_NaN_position, __pyx_t_8);
            __pyx_t_8 = 0;
</pre><pre class='cython line score-0'>&#xA0;290: </pre>
<pre class='cython line score-0'>&#xA0;291: 						<span class="c"># Extract the values in the local data that are not NaN</span></pre>
<pre class='cython line score-0'>&#xA0;292: 						<span class="n">local_data_no_nan</span> <span class="o">=</span>\</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+293: 						 <span class="n">local_data_flat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">NaN_position</span><span class="p">)]</span></pre>
<pre class='cython code score-56'>            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_logical_not);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
              __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
              if (likely(__pyx_t_4)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
              }
            }
            if (!__pyx_t_4) {
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_NaN_position);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            } else {
              __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_NaN_position);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_NaN_position);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_NaN_position);
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_local_data_flat), __pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            __pyx_t_33 = ((PyArrayObject *)__pyx_t_5);
            {
              __Pyx_BufFmt_StackElem __pyx_stack[1];
              <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_33, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
              if (unlikely(__pyx_t_12 &lt; 0)) {
                <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
                if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_local_data_no_nan, &amp;__Pyx_TypeInfo_nn___pyx_t_16calc_local_stats_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
                  Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
                  <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
                } else {
                  <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
                }
              }
              __pyx_pybuffernd_local_data_no_nan.diminfo[0].strides = __pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_local_data_no_nan.diminfo[0].shape = __pyx_pybuffernd_local_data_no_nan.rcbuffer-&gt;pybuffer.shape[0];
              if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_33 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_local_data_no_nan, ((PyArrayObject *)__pyx_t_5));
            __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;294: </pre>
<pre class='cython line score-0'>&#xA0;295: 						<span class="c"># Calculate the kurtosis of the local data that has had </span></pre>
<pre class='cython line score-0'>&#xA0;296: 						<span class="c"># the NaN values removed, and store it in the </span></pre>
<pre class='cython line score-0'>&#xA0;297: 						<span class="c"># corresponding array</span></pre>
<pre class='cython line score-0'>&#xA0;298: 						<span class="c"># (stat_dict[&#39;kurtosis&#39;])[j,k] =\</span></pre>
<pre class='cython line score-0'>&#xA0;299: 						<span class="c">#  stats.kurtosis(local_data_no_nan)</span></pre>
<pre class='cython line score-37' onclick='toggleDiv(this)'>+300: 						<span class="n">kurt_arr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">local_data_no_nan</span><span class="p">)</span></pre>
<pre class='cython code score-37'>            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_stats);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_kurtosis);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_8 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
              __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
              if (likely(__pyx_t_8)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
              }
            }
            if (!__pyx_t_8) {
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, ((PyObject *)__pyx_v_local_data_no_nan));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            } else {
              __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_local_data_no_nan));
              <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_local_data_no_nan));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_local_data_no_nan));
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_34 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_5);<span class='error_goto'> if (unlikely((__pyx_t_34 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_37 = __pyx_v_j;
            __pyx_t_38 = __pyx_v_k;
            __pyx_t_12 = -1;
            if (__pyx_t_37 &lt; 0) {
              __pyx_t_37 += __pyx_pybuffernd_kurt_arr.diminfo[0].shape;
              if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_12 = 0;
            } else if (unlikely(__pyx_t_37 &gt;= __pyx_pybuffernd_kurt_arr.diminfo[0].shape)) __pyx_t_12 = 0;
            if (__pyx_t_38 &lt; 0) {
              __pyx_t_38 += __pyx_pybuffernd_kurt_arr.diminfo[1].shape;
              if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_12 = 1;
            } else if (unlikely(__pyx_t_38 &gt;= __pyx_pybuffernd_kurt_arr.diminfo[1].shape)) __pyx_t_12 = 1;
            if (unlikely(__pyx_t_12 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
              <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_16calc_local_stats_DTYPE_t *, __pyx_pybuffernd_kurt_arr.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_kurt_arr.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_kurt_arr.diminfo[1].strides) = __pyx_t_34;
            goto __pyx_L19;
          }
          __pyx_L19:;
        }
        __pyx_L17:;
      }
</pre><pre class='cython line score-0'>&#xA0;301: </pre>
<pre class='cython line score-0'>&#xA0;302: 				<span class="c"># When the code reaches this point, all of the required </span></pre>
<pre class='cython line score-0'>&#xA0;303: 				<span class="c"># statistics have been calculated for this pixel</span></pre>
<pre class='cython line score-0'>&#xA0;304: </pre>
<pre class='cython line score-0'>&#xA0;305: 			<span class="c"># When the code reaches this point, statistics have been calculated </span></pre>
<pre class='cython line score-0'>&#xA0;306: 			<span class="c"># for all of the pixels in this row</span></pre>
<pre class='cython line score-0'>&#xA0;307: </pre>
<pre class='cython line score-0'>&#xA0;308: 			<span class="c"># Every 100 rows, print out a message to show where the code is up to</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+309: 			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="mf">100</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__Pyx_mod_long((__pyx_v_j + 1), 100) == 0) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;310: 				<span class="c"># Another 100 rows have been completed, so print a message</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+311: 				<span class="k">print</span> <span class="s">&#39;{} rows calculated&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-31'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_rows_calculated, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_j + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_8 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_8)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          }
        }
        if (!__pyx_t_8) {
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        } else {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        goto __pyx_L20;
      }
      __pyx_L20:;
    }
</pre><pre class='cython line score-0'>&#xA0;312: </pre>
<pre class='cython line score-0'>&#xA0;313: 		<span class="c"># When the code reaches this point, statistics have been calculated for</span></pre>
<pre class='cython line score-0'>&#xA0;314: 		<span class="c"># all of the pixels, for this particular value of the final resolution</span></pre>
<pre class='cython line score-0'>&#xA0;315: </pre>
<pre class='cython line score-0'>&#xA0;316: 		<span class="c"># Next, we want to save the produced maps of the local statistics</span></pre>
<pre class='cython line score-0'>&#xA0;317: </pre>
<pre class='cython line score-0'>&#xA0;318: 		<span class="c"># Convert the matrix of values for this statistic into a FITS file, </span></pre>
<pre class='cython line score-0'>&#xA0;319: 		<span class="c"># and save the result using the same header as the input CGPS data. </span></pre>
<pre class='cython line score-0'>&#xA0;320: 		<span class="c"># The FITS file is saved in the same location as the CGPS data</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+321: 		<span class="n">skew_FITS</span> <span class="o">=</span> <span class="n">mat2FITS_Image</span><span class="p">(</span><span class="n">skew_arr</span><span class="p">,</span> <span class="n">fits_hdr</span><span class="p">,</span>\</pre>
<pre class='cython code score-2'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_mat2FITS_Image);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+322: 		 <span class="n">output_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;skew&#39;</span> <span class="o">+</span> <span class="s">&#39;.fits&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-40'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_output_filenames, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_n_s_skew);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_kp_s_fits_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_1 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_1 = 1;
      }
    }
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_skew_arr));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_skew_arr));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_1, ((PyObject *)__pyx_v_skew_arr));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fits_hdr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fits_hdr);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_1, __pyx_v_fits_hdr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_1, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_skew_FITS, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;323: </pre>
<pre class='cython line score-0'>&#xA0;324: 		<span class="c"># Print a message to the screen, to show that a FITS file was </span></pre>
<pre class='cython line score-0'>&#xA0;325: 		<span class="c"># produced for the current statistic</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+326: 		<span class="k">print</span> <span class="s">&#39;FITS file saved for skewness&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_FITS_file_saved_for_skewness) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;327: </pre>
<pre class='cython line score-0'>&#xA0;328: 		<span class="c"># Convert the matrix of values for this statistic into a FITS file, </span></pre>
<pre class='cython line score-0'>&#xA0;329: 		<span class="c"># and save the result using the same header as the input CGPS data. </span></pre>
<pre class='cython line score-0'>&#xA0;330: 		<span class="c"># The FITS file is saved in the same location as the CGPS data</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+331: 		<span class="n">stat_FITS</span> <span class="o">=</span> <span class="n">mat2FITS_Image</span><span class="p">(</span><span class="n">kurt_arr</span><span class="p">,</span> <span class="n">fits_hdr</span><span class="p">,</span>\</pre>
<pre class='cython code score-2'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_mat2FITS_Image);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+332: 		 <span class="n">output_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;kurt&#39;</span> <span class="o">+</span> <span class="s">&#39;.fits&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-40'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_output_filenames, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_n_s_kurt);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_kp_s_fits_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    __pyx_t_1 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_1 = 1;
      }
    }
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kurt_arr));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kurt_arr));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_1, ((PyObject *)__pyx_v_kurt_arr));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fits_hdr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fits_hdr);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_1, __pyx_v_fits_hdr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_1, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stat_FITS, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;333: </pre>
<pre class='cython line score-0'>&#xA0;334: 		<span class="c"># Print a message to the screen, to show that a FITS file was </span></pre>
<pre class='cython line score-0'>&#xA0;335: 		<span class="c"># produced for the current statistic</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+336: 		<span class="k">print</span> <span class="s">&#39;FITS file saved for kurtosis&#39;</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_FITS_file_saved_for_kurtosis) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;337: </pre>
<pre class='cython line score-0'>&#xA0;338: 		<span class="c"># # Loop over all of the statistics that were calculated</span></pre>
<pre class='cython line score-0'>&#xA0;339: 		<span class="c"># for stat in stat_list:</span></pre>
<pre class='cython line score-0'>&#xA0;340: 		<span class="c"># 	# Convert the matrix of values for this statistic into a FITS file, </span></pre>
<pre class='cython line score-0'>&#xA0;341: 		<span class="c"># 	# and save the result using the same header as the input CGPS data. </span></pre>
<pre class='cython line score-0'>&#xA0;342: 		<span class="c"># 	# The FITS file is saved in the same location as the CGPS data</span></pre>
<pre class='cython line score-0'>&#xA0;343: 		<span class="c"># 	stat_FITS = mat2FITS_Image(stat_dict[stat], fits_hdr,\</span></pre>
<pre class='cython line score-0'>&#xA0;344: 		<span class="c"># 	 output_filenames[i] + &#39;_{}&#39;.format(stat) + &#39;.fits&#39;)</span></pre>
<pre class='cython line score-0'>&#xA0;345: </pre>
<pre class='cython line score-0'>&#xA0;346: 		<span class="c"># 	# Print a message to the screen, to show that a FITS file was </span></pre>
<pre class='cython line score-0'>&#xA0;347: 		<span class="c"># 	# produced for the current statistic</span></pre>
<pre class='cython line score-0'>&#xA0;348: 		<span class="c"># 	print &#39;FITS file saved for {}&#39;.format(stat)</span></pre>
<pre class='cython line score-0'>&#xA0;349: </pre>
<pre class='cython line score-0'>&#xA0;350: 		<span class="c"># At this point, all FITS files have been saved for the required </span></pre>
<pre class='cython line score-0'>&#xA0;351: 		<span class="c"># statistics, so print a message to the screen about this</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+352: 		<span class="k">print</span> <span class="s">&#39;All FITS files saved for {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-31'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_All_FITS_files_saved_for, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_files, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
</pre><pre class='cython line score-0'>&#xA0;353: </pre>
<pre class='cython line score-0'>&#xA0;354: 	<span class="c"># When the code reaches this point, all of the FITS files have been saved</span></pre>
<pre class='cython line score-0'>&#xA0;355: 	<span class="c"># Print a message stating this</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+356: 	<span class="k">print</span> <span class="s">&#39;All FITS files saved successfully&#39;</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_All_FITS_files_saved_successfull) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;357: </pre>
<pre class='cython line score-0'>&#xA0;358: 	<span class="c"># Since the code has run successfully, return 1</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+359: 	<span class="k">return</span> <span class="mf">1</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  __pyx_r = __pyx_int_1;
  goto __pyx_L0;
</pre></div></body></html>
